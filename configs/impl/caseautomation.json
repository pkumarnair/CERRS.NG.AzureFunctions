{
	"applicationName":"caseautomation",
	"emailinfo":{
		"emailto":["jun.yang@cognosante.com"],
		"emailfrom":"caseautomationsupport@cognosante.com"
	},
	"events":[
		{
			"eventTrigger":"StartCaseAutomation",
			"eventDescription":"Create a cluster",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"key":"runbookName","value":"Create-CaseAutomationCluster"},
				{"key":"resourceGroupName","value":"CERRS-PROD-RG"},
				{"key":"automationAccount","value":"env-automationaccountname"},
 				{"key":"location","value":"env-location"},
 				{"key":"subscriptionId","value":"env-subscriptionid"},
 				{"key":"storageAccountName","value":"env-storageAccountName"},
 				{"key":"containerName","value":"env-clustercontainer"},
 				{"key":"clusterName","value":"env-clustername"},
				{"key":"outMessage","value":"ClusterCreated"},
				{"key":"pswrd","value":"env-clusterpassword"},
				{"key":"ScriptActionURI","value":"https://cerrsimplhdispark.blob.core.usgovcloudapi.net/cerrscaseautomation/ca-scriptaction"},
				{"key":"queueName","value":"env-listenerqueueName"},
				{"key":"clusterResourceGroup","value":"env-spnresourcegroupname"},
				{"key":"VirtualNetworkId","value":"env-VirtualNetworkId"},
				{"key":"SubnetName","value":"env-SubnetName"}
			]
		},
		{
			"eventTrigger":"ClusterCreated",
			"eventDescription":"Create messages for parallel jobs",
			"eventFunction":"Initiate-Parallel-Requests",
			"eventParams":[
				{"key":"queuename","value":"env-listenerqueueName"},
				{"key":"connectionstring","value":"env-AzureWebJobsStorage"},
				{"key":"storagekey","value":"env-storageaccountkey"},
				{"key":"storageaccountname","value":"env-storageAccountName"},
				{"key":"message","value":"StartFFMParquetConversion"},
				{"key":"message","value":"StartRCNOParquetConversion"},
				{"key":"message","value":"Start1095AParquetConversion"},
				{"key":"message","value":"StartCaseClassification"}
			]
		},
		{
			"eventTrigger":"StartCaseClassification",
			"eventDescription":"Case Classification",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/CaseClassification.py"},
				{"key":"outMessage","value":"ConversionCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"ca-python/pickle/"},
				{"key":"pyargs","value":"hics_model.sav2"},
				{"key":"pyargs","value":"ca-inputs/hics/"},
				{"key":"pyargs","value":"ca-outputs/classification/"},
				{"key":"pyargs","value":"ClassifiedCases.csv"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},	
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"StartFFMParquetConversion",
			"eventDescription":"Convert FFM File to Parquet",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/FFMConvertToParquet.py"},
				{"key":"outMessage","value":"ConversionCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"ca-inputs/ffm/"},
				{"key":"pyargs","value":"ca-parquet/ffm/"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"Start1095AParquetConversion",
			"eventDescription":"Convert 1095A File to Parquet",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/1095AConvertToParquet.py"},
				{"key":"outMessage","value":"ConversionCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"ca-inputs/1095a/"},
				{"key":"pyargs","value":"ca-parquet/1095a/"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"StartRCNOParquetConversion",
			"eventDescription":"Convert RCNO File to Parquet",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/RCNOConvertToParquet.py"},
				{"key":"outMessage","value":"ConversionCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"ca-inputs/rcno/"},
				{"key":"pyargs","value":"ca-parquet/rcno/"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"ConversionCompleted",
			"eventDescription":"Waits for jobs that run conncurrently to trigger the next job",
			"eventFunction":"Wait-For-Concurrent-Jobs",
			"eventParams":[
				{"key":"blobname","value":"jobwait/waitfordataextraction"},
				{"key":"currentmessage","value":"ConversionCompleted"},
				{"key":"outmessage","value":"StartDataExtraction"},
				{"key":"waitmessage","value":"FFMParquetConversionComplete"},
				{"key":"waitmessage","value":"RCNOParquetConversionComplete"},
				{"key":"waitmessage","value":"1095AParquetConversionComplete"},
				{"key":"waitmessage","value":"CaseClassificationComplete"}
			]
		},
		{
			"eventTrigger":"StartDataExtraction",
			"eventDescription":"Data Extraction from FFM, 1095A and RCNO",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/CaseDataExtraction.py"},
				{"key":"outMessage","value":"DataExtractionCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"ca-outputs/classification/ClassifiedCases.csv"},
				{"key":"pyargs","value":"ca-parquet/rcno/"},
				{"key":"pyargs","value":"ca-parquet/ffm/"},
				{"key":"pyargs","value":"ca-parquet/1095a/"},
				{"key":"pyargs","value":"ca-outputs/extraction/"},
				{"key":"pyargs","value":"CaseDataExtract.csv"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"DataExtractionCompleted",
			"eventDescription":"Case Compare which compares data from HICS, RCNO, FFM and 1095A and outputs recoomendations",
			"eventFunction":"Initiate-Livy",
			"eventParams":[
				{"key":"mainfile","value":"ca-python/src/CaseCompare.py"},
				{"key":"outMessage","value":"CaseCompareCompleted"},
				{"key":"pyargs","value":"env-storageAccountName"},
				{"key":"pyargs","value":"env-storageaccountkey"},
				{"key":"pyargs","value":"env-endpoint"},
				{"key":"pyargs","value":"env-clustercontainer"},
				{"key":"pyargs","value":"env-listenerqueueName"},
				{"key":"pyargs","value":"ca-outputs/extraction/CaseDataExtract.csv"},
				{"key":"pyargs","value":"ca-outputs/compare/"},
				{"key":"pyargs","value":"Caseoutput.csv"},
				{"key":"pyargs","value":"cerrscafile"},
				{"key":"pyfiles","value":"ca-python/src/cafunctions.py"},
				{"key":"pyconf-spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2"}
			]
		},
		{
			"eventTrigger":"CaseCompareCompleted",
			"eventDescription":"Delete a cluster",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"key":"runbookName","value":"Delete-CaseAutomationCluster"},
				{"key":"resourceGroupName","value":"CERRS-PROD-RG"},
				{"key":"automationAccount","value":"env-automationaccountname"},
 				{"key":"subscriptionId","value":"env-subscriptionid"},
 				{"key":"clusterName","value":"env-clustername"},
 				{"key":"storageAccountName","value":"env-storageAccountName"},
				{"key":"queueName","value":"env-listenerqueueName"},
				{"key":"outMessage","value":"ClusterDeleted"},
				{"key":"clusterResourceGroup","value":"env-spnresourcegroupname"}
			]
		},
		{
			"eventTrigger":"ExecuteRestAPI",
			"eventDescription":"Execute a Rest API",
			"eventFunction":"Execute-RestRequest",
			"eventParams":[
				{"key":"resturl","value":"https:/mcr-cc.test.cognosante.cc/v1/AddressInfo"},
				{"key":"restMethod","value":"Get"},
				{"key":"restparams-street","value":"+509+Adams+Ave+Apt+1A+Cape+Canaveral+FL+32920"},
				{"key":"header-callingApp","value":"TestFramework"},
				{"key":"header-callingUser","value":"AutomationUser"},
				{"key":"header-x-cognosante-authentication","value":"6d5d56f7cf494134a96cc6910549341a"},
				{"key":"header-Authorization","value":"Basic eF9jb2dub3NhbnRlX2F1dGhlbnRpY2F0aW9uOjZkNWQ1NmY3Y2Y0OTQxMzRhOTZjYzY5MTA1NDkzNDFh"}
			]
		}
	]
}