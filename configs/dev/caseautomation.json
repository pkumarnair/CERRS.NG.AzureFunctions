{
	"applicationName":"caseautomation",
	"emailinfo":{
		"emailto":["Pradeep.Kumar@cognosante.com"],
		"emailfrom":"caseautomationsupport@cognosante.com"
	,"pass":"true"},
	"events":[
		{
			"eventTrigger":"StartCaseAutomation",
			"eventDescription":"Create a cluster",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Create-CaseAutomationCluster","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
 				{"type":"string","key":"location","value":"$env:location","pass":"true"},
 				{"type":"string","key":"subscriptionId","value":"$env:subscriptionid","pass":"true"},
 				{"type":"string","key":"storageAccountName","value":"$env:storageAccountName","pass":"true"},
 				{"type":"string","key":"containerName","value":"$env:clustercontainer","pass":"true"},
 				{"type":"string","key":"clusterName","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"outMessage","value":"ClusterCreated","pass":"true"},
				{"type":"string","key":"pswrd","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"ScriptActionURI","value":"https://$env:storageAccountName.blob.$env:endpoint/$env:clustercontainer/ca-scriptaction","pass":"true"},
				{"type":"string","key":"queueName","value":"$env:listenerqueueName","pass":"true"},
				{"type":"string","key":"VirtualNetworkId","value":"/subscriptions/9f657357-308f-4780-aee7-070aa7f55580/resourceGroups/CERRS-DEV-TEST-RG/providers/Microsoft.Network/virtualNetworks/CERRS-DEV-TEST","pass":"true"},
				{"type":"string","key":"SubnetName","value":"/subscriptions/9f657357-308f-4780-aee7-070aa7f55580/resourceGroups/CERRS-DEV-TEST-RG/providers/Microsoft.Network/virtualNetworks/CERRS-DEV-TEST/subnets/CERRS-TST-DMZ-NET","pass":"true"},
				{"type":"string","key":"endpoint","value":"$env:endpoint","pass":"true"},
				{"type":"string","key":"environment","value":"AzureUSGovernment","pass":"true"}
			]
		},
		{
			"eventTrigger":"ClusterCreated",
			"eventDescription":"Create messages for parallel jobs",
			"eventFunction":"Initiate-Parallel-Requests",
			"eventParams":[
				{"type":"string","key":"queuename","value":"$env:listenerqueueName","pass":"true"},
				{"type":"string","key":"connectionstring","value":"$env:AzureWebJobsStorage","pass":"true"},
				{"type":"string","key":"storagekey","value":"$env:storageaccountkey","pass":"true"},
				{"type":"string","key":"storageaccountname","value":"$env:storageAccountName","pass":"true"},
				{"type":"string","key":"message","value":"StartFFMParquetConversion","pass":"true"},
				{"type":"string","key":"message","value":"StartRCNOParquetConversion","pass":"true"},
				{"type":"string","key":"message","value":"Start1095AParquetConversion","pass":"true"},
				{"type":"string","key":"message","value":"StartCaseClassification","pass":"true"}
			]
		},
		{
			"eventTrigger":"StartFFMParquetConversion",
			"eventDescription":"Convert FFM File to Parquet",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/FFMConvertToParquet.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"ConversionCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-inputs/ffm/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/ffm/","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"Start1095AParquetConversion",
			"eventDescription":"Convert 1095A File to Parquet",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/1095AConvertToParquet.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"ConversionCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-inputs/1095a/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/1095a/","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"StartRCNOParquetConversion",
			"eventDescription":"Convert RCNO File to Parquet",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/RCNOConvertToParquet.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"ConversionCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-inputs/rcno/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/rcno/","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"StartCaseClassification",
			"eventDescription":"Case Classification",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/CaseClassification.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"ConversionCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-python/pickle/","pass":"true"},
				{"type":"list","key":"pyargs","value":"hics_model.sav2","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-inputs/hics/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/classification/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ClassifiedCases.csv","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},	
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"ConversionCompleted",
			"eventDescription":"Waits for jobs that run conncurrently to trigger the next job",
			"eventFunction":"Wait-For-Concurrent-Jobs",
			"eventParams":[
				{"type":"string","key":"blobname","value":"jobwait/waitfordataextraction","pass":"true"},
				{"type":"string","key":"currentmessage","value":"ConversionCompleted","pass":"true"},
				{"type":"string","key":"outmessage","value":"StartDataExtraction","pass":"true"},
				{"type":"string","key":"waitmessage","value":"FFMParquetConversionComplete","pass":"true"},
				{"type":"string","key":"waitmessage","value":"RCNOParquetConversionComplete","pass":"true"},
				{"type":"string","key":"waitmessage","value":"1095AParquetConversionComplete","pass":"true"},
				{"type":"string","key":"waitmessage","value":"CaseClassificationComplete","pass":"true"}
			]
		},
		{
			"eventTrigger":"StartDataExtraction",
			"eventDescription":"Data Extraction from FFM, 1095A and RCNO",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/CaseDataExtraction.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"DataExtractionCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/classification/ClassifiedCases.csv","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/rcno/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/ffm/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-parquet/1095a/","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/extraction/","pass":"true"},
				{"type":"list","key":"pyargs","value":"CaseDataExtract.csv","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"DataExtractionCompleted",
			"eventDescription":"Smarty Street Validation",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/CASmartyStreetValidation.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"SmartyStreetVCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/extraction/CaseDataExtract.csv","pass":"true"},
				{"type":"list","key":"pyargs","value":"https://mcr-cc.test.cognosante.cc/v1/AddressInfo?","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/smartystreetvalidation/","pass":"true"},
				{"type":"list","key":"pyargs","value":"CASmartyStreetResults.csv","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		}, 
		{
			"eventTrigger":"SmartyStreetVCompleted	",
			"eventDescription":"Case Compare which compares data from HICS, RCNO, FFM and 1095A and outputs recoomendations",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Initiate-Livy","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
				{"type":"string","key":"clusteruser","value":"$env:clusteruser","pass":"true"},
				{"type":"string","key":"SecurePassword","value":"$env:clusterpassword","pass":"true"},
				{"type":"string","key":"clustername","value":"$env:clustername","pass":"true"},
				{"type":"string","key":"hybridAutoServer","value":"$env:hybridAutoServer","pass":"false"},
				{"type":"string","key":"hybridDomainUser","value":"$env:hybridDomainUser","pass":"true"},
				{"type":"string","key":"livyurl","value":"https://$env:clustername.azurehdinsight.us/livy/batches","pass":"true"},
				{"type":"string","key":"mainfile","value":"$env:pythonJobLocation/ca-python/src/CaseCompare.py","pass":"true"},
				{"type":"string","key":"outMessage","value":"CaseCompareCompleted","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageAccountName","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:storageaccountkey","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:endpoint","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:clustercontainer","pass":"true"},
				{"type":"list","key":"pyargs","value":"$env:listenerqueueName","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/extraction/CaseDataExtract.csv","pass":"true"},
				{"type":"list","key":"pyargs","value":"ca-outputs/compare/","pass":"true"},
				{"type":"list","key":"pyargs","value":"Caseoutput.csv","pass":"true"},
				{"type":"list","key":"pyargs","value":"cerrscafile","pass":"true"},
				{"type":"list","key":"pyfiles","value":"$env:pythonJobLocation/ca-python/src/cafunctions.py","pass":"true"},
				{"type":"hashtable","key":"pyconf","keyname":"spark.yarn.appMasterEnv.PYSPARK_PYTHON","value":"python2","pass":"true"}
			]
		},
		{
			"eventTrigger":"CaseCompareCompleted",
			"eventDescription":"Delete a cluster",
			"eventFunction":"Execute-Runbook",
			"eventParams":[
				{"type":"string","key":"runbookName","value":"Delete-CaseAutomationCluster","pass":"true"},
				{"type":"string","key":"resourceGroupName","value":"$env:spnresourcegroupname","pass":"true"},
				{"type":"string","key":"automationAccount","value":"$env:automationaccountname","pass":"true"},
 				{"type":"string","key":"subscriptionId","value":"$env:subscriptionid","pass":"true"},
 				{"type":"string","key":"clusterName","value":"$env:clustername","pass":"true"},
 				{"type":"string","key":"storageAccountName","value":"$env:storageAccountName","pass":"true"},
				{"type":"string","key":"queueName","value":"$env:listenerqueueName","pass":"true"},
				{"type":"string","key":"outMessage","value":"ClusterDeleted","pass":"true"}
			]
		,"pass":"true"}
	]
,"pass":"true"}